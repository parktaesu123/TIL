## Cookie 🎄

### 나는 왜 쿠키, 세션, 토큰에 대해서 공부하게 되었나?

---

HTTP 프로토콜의 특징을 공부하며 **`Connectionless`**(비연결성)와 **`Stateless`**(무상태)에 대해서 공부하게 되었고, 이러한 특성때문에 인증과 인가 과정에 대해 의문을 품으며 자연스레 **쿠키, 세션 토큰**에 대한 궁금증이 생겼다.

### 쿠키, 세션, 토큰?

---

> **흔히 말하는 서버에서 클라이언트를 인증하는 방식이다.**
> 
- HTTP 프로토콜은 서버의 자원을 아끼고 확장성을 올리기 위해 클라이언트와 서버가 연결하여 요청과 응답이 이루어지면 그 연결을 곧바로 끊어버린다. → **`Connectionless`**
- 이로인해 서버는 이전 요청에 대한 상태를 기록하지 못하고 서버가 클라이언트를 식별하지 못한다. → **`Stateless`**
- 위 같은 HTTP 프로토콜의 특징 때문에 한 특정한 작업을 취할때마다 인증을 해주어야 하는 불상사가 발생하게 된다.

<aside>

🚀 웹의 개인화는 클라이언트에 맞는 데이터를 제공해 주어야 하기에 클라이언트 식별이 필요하다. 따라서 이와같은 문제점을 해결하기 위해 생겨난 것이 바로 쿠키이다.

</aside>

## 쿠키(Cookie)

---

> 쿠키는 사용자 아이디, 비밀번호와 같은 데이터 조각이 있는 텍스트 파일이다.
> 
- 쿠키는 사용자를 식별하기 위해 사용된다.
    - 클라이언트(사용자)와 서버 간의 상태 정보를 저장하고 관리하기 위해 사용된다.
    - 사용자의 상태나 정보를 유지할 수 있다. (계속 로그인 안해도 된다.)
- 클라이언트가 어떠한 웹 사이트를 방문할 경우, 그 사이트가 사용하고 있는 서버를 통해 클라이언트의 브라우저에 설치되는 **작은 기록 정보 파일**이다
    - 쿠키의 가장 두드러지는 특징은 사용자 관련 정보를 브라우저가 관리한다는 것이다.
    - 쿠키는 브라우저에 종속 되어있다.
        
        > 서버에서 받은 클라이언트의 쿠키는 전적으로 브라우저가 관리한다.
        > 
        - 크롬, 엣지, 파이어폭스 등등
        - 여러 종류의 브라우저로 동일한 사이트에 들어가면 똑같은 내용의 쿠키값을 저장한다 하더라도 이 쿠키들은 서로 별개이다.
- 쿠키는 **`key-value`** 형식의 문자열 덩어리이다.

<aside>

**key :** 데이터의 식별자 → 이 식별자를 통해 값을 찾을 수 있다.

**value** **:** key에 대응하는 실제 데이터

</aside>

**`key value`**의 장점

- 쉽게 값을 저장하고, 식별자를 통해 찾을 수 있다.

```mathematica
Set-Cookie: session_id=abc123; Path=/; HttpOnly

// key = session_id
// value = abc123
```

## 쿠키의 동작과정

---

(쿠키 생성)

- 사용자가 로그인을 하기 위해 아이디와 비밀번호를 입력해 서버에 요청하면, 서버는 로그인 정보를 회원저장소에서 찾아 memberId를 key로 하는 Cookie를 생성해 웹브라우저에게 응답한다.
- 웹브라우저는 서버의 응답 메시지를 받아 Cookie를 쿠키 저장소에 저장한다.

(쿠키 전달)

- Cookie를 쿠키 저장소에 저장했으니, 이제는 서버에 요청을 할 때마다 쿠키 저장소에서 쿠키를 찾아서 요청메세지의 헤더에 담는다.

- 서버로 보내는 모든 요청 메세지에 쿠키 정보가 자동으로 포함된다. 따라서 서버는 요청을 한 클라이언트가 누구인지, 클라이언트를 식별할 수 있다.

### 쿠키의 활용도

---

> 쿠키는 서버와 통신할 때 뿐만 아니라 사용자의 편의를 위해 여러 기능들을 제공한다.
> 

1. **세션 관리 :** 서버간 일시적인 연결 유지에 이용
    - 로그인 유지, 사용자의 장바구니 제품 유지 등등
2. **개인화 :** 웹 사이트 사용자에 대한 선호, 테마 세팅
    - 다크모드, 언어 설정 등등
3. **트래킹 :** 사용자의 행동을 기록하고 분석
    - 분석 데이터 수집 및 광고

### 쿠키의 한계

---

<aside>

쿠키의 정보는 클라이언트 측에서 관리 되기 때문에 악용될 우려가 있고, 보안에 취약하여 탈취당할 위험이 있다. → 쿠키에는 민감한 개인정보나 중요한 정보를 담아서는 안된다.

요새는 쿠키가 트래킹에 과도하게 이용되어 과한 광고 수단으로 남용되고 있다.

</aside>

> 쿠키에는 사용자에 대한 직접적인 정보를 담지 않고 JWT나 세션 ID 같은 정보를 보관하여 자동으로 서버에 보내는 역할을 한다.
> 

### 참고자료

https://velog.io/@choidongkuen/Server-%EC%BF%A0%EA%B8%B0%EC%84%B8%EC%85%98%ED%86%A0%ED%81%B0-%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%B4%85%EC%8B%9C%EB%8B%A4

https://inpa.tistory.com/entry/HTTP-%F0%9F%8C%90-%EC%9B%B9-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9D%98-%EC%BF%A0%ED%82%A4-%EA%B0%9C%EB%85%90-Cookie-%ED%97%A4%EB%8D%94-%EB%8B%A4%EB%A3%A8%EA%B8%B0

https://www.kaspersky.co.kr/resource-center/definitions/cookies

https://velog.io/@rlfrkdms1/%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%98-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%98-%EA%B5%AC%EC%A1%B0
