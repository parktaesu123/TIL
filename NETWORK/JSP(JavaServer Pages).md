## JSP란?

> **HTML 코드**에 **JAVA 코드**를 사용하여 **동적 웹페이지**를 생성하는 웹 어플리케이션 도구(라이브러리)이다.
> 
- **`JSP`**는 HTML 안에 자바 코드를 삽입하는 형식으로 코드를 작성한다.
- **`JSP`** 가 실행되면 자바 서블릿(Servlet) 으로 변환되며 웹 어플리케이션 서버에서 동작되면서 필요한 기능을 수행하고, 그렇게 생성된 데이터를 웹페이지와 함께 클라이언트로 응답한다.

<aside>
💡

**HTML ==** 템플릿
- 항상 정해진 모양(상자)으로만 택배를 포장한다.

**JSP ==** 상자에 넣을 내용을 사용자마다 다르게 넣어주는 기계

- 김씨가 주문하면 "김씨의 주문: 신발"이라는 상자를, 이씨가 주문하면 "이씨의 주문: 옷"이라는 상자를 만들어 준다.

</aside>

## JSP vs Sevlet

---

- 서블릿은 클래스의 형태를 띄고 있고 자바의 형태를 온전히 가진다.
    - 서블릿은 자바의 형태고 자바 언어를 쓴다.
    - .java가 확장자
- JSP는 HTML 코드를 기반으로 그 사이에 자바코드를 삽입하는 식으로 만든다.
    - JSP는 HTML 안에 자바 코드를 삽입하는 형식으로 코드를 작성한다.
    - .jsp가 확장자

- 서블릿은 자바 기반이므로 결과물 출력을 위해서 HTML태그를 일일이 출력해야 페이지를 만들 수 있다.
- JSP는 HTML 태그 사이에 자바 코드를 끼워 넣는 것이기 때문에 상대적으로 결과물 표현 코드가 짧다.

## JSP 엔진

> 웹 서버에는 **`JSP 엔진`**, 즉 JSP 페이지를 처리할 컨테이너가 필요하다.
> 
- JSP 컨테이너는 JSP 페이지에 대한 요청을 가로채는 역할을 한다.
- JSP 컨테이너는 웹 서버와 함께 작동하여 JSP에 필요한 런타임 환경과 기타 서비스를 제공한다.
- JSP 엔진은 JSP 파일에 대한 서블릿이 이미 존재하는지, JSP의 수정 날짜가 서블릿보다 오래된지 확인한다.
    - JSP가 생성된 서블릿보다 오래된 경우 JSP 컨테이너는 JSP가 변경되지 않았고 생성된 서블릿이 여전히 JSP의 내용과 일치한다고 가정한다.

## 동작 과정

---

*위 그림을 바탕으로 동작구조 설명*

1. **브라우저에서 JSP 페이지 요청**
    - 사용자가 브라우저에서 JSP 페이지를 요청한다. (예: **`http://example.com/hello.jsp`**)
    - 이 요청은 **HTTP 요청**으로 웹 서버로 전달된다.

1. **웹 서버는 JSP 요청을 인식**
    - 웹 서버는 요청된 URL이 **`.jsp`**로 끝나는 것을 보고 **"이건 JSP 파일이네!"** 라고 판단한다.
    - 일반 HTML 파일이라면 그냥 바로 클라이언트(브라우저)로 전달하겠지만, JSP 파일은 다르다. **JSP 엔진**에 이 요청을 전달해야 한다.

1. **JSP 엔진이 JSP 파일을 서블릿으로 변환**
    - JSP 엔진은 요청된 JSP 파일(예: **`hello.jsp`**)을 읽어서 내부적으로 서블릿(Java 코드)로 변환한다.
        - 이 과정에서, JSP 파일에 있는 정적 텍스트(HTML 코드)는 **`println()`** 같은 Java 출력 코드로 변환된다.
    - 예시
        - JSP 파일
        
        ```jsx
        <html>
          <body>
            <h1>안녕하세요, <%= name %>!</h1>
          </body>
        </html>
        ```
        
        - 서블릿으로 변환된 코드
        
        ```jsx
        out.println("<html>");
        out.println("<body>");
        out.println("<h1>안녕하세요, " + name + "!</h1>");
        out.println("</body>");
        out.println("</html>");
        ```
        

1. **서블릿 컴파일**
    - JSP 엔진은 변환된 서블릿 코드를 **컴파일**해서 실행 가능한 **`.class`** 파일(바이트코드)로 만든다.
    - 이 **`.class`** 파일은 Java로 작성된 일반 서블릿처럼 서버에서 실행될 준비를 마친다.

1. **서블릿 엔진 서블릿 실행**
    - 서블릿 엔진이 컴파일된 서블릿 클래스를 실행한다.
    - 실행 중에 서블릿은 클라이언트 요청에 맞는 동작을 수행하고, 동적으로 HTML 페이지를 생성합니다.
    - 예를 들어 사용자가 **`http://example.com/hello.jsp?name=John`**을 요청했다면, 서블릿은 **`name=박태수`**을 받아들여 "안녕하세요, 박태수!"이라는 HTML을 생성한다.

1. **서블릿 엔진이 웹 서버로 HTML 전달**
    - 서블릿 엔진은 생성된 HTML을 **웹 서버에 반환**한다.
    - 웹 서버는 이 HTML을 **HTTP 응답** 형태로 사용자(브라우저)에게 전달한다.

1. **브라우저가 HTML 페이지 표시**
    - 브라우저는 전달받은 **HTTP 응답**을 읽고, 내부의 HTML 내용을 화면에 표시한다.
    - 이 과정에서 브라우저는 HTML이 **정적 페이지인지 동적으로 생성된 페이지인지 구별하지 못하고**, 그냥 일반 HTML 페이지처럼 처리한다.

### 참고자료

https://javacpro.tistory.com/43

https://velog.io/@junkue20/JSP%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C

https://sgcomputer.tistory.com/227

https://m.blog.naver.com/acornedu/221128616501

https://hrcony8753.tistory.com/6

https://www.tutorialspoint.com/jsp/jsp_architecture.htm
